import{j as e}from"./jsx-runtime-CDt2p4po.js";import{r as n}from"./index-GiUgBvb1.js";import{c as k,u as le,R as c,C as T,L as de}from"./LanguageContext-n6OuJeuk.js";import{S as W}from"./ServiceLogo-CpE1bRn6.js";import{f as ue,g as me,m as pe}from"./subscriptions-C-gF_7_X.js";import{B as O}from"./Button-DsnxW2UV.js";import{c as Q}from"./cn-C0Y9tLwQ.js";import{I as P}from"./Input-CpKppwqq.js";import{M as he}from"./Modal-jGAm4gdw.js";import{m as V}from"./proxy-Cm3FBkwj.js";import"./index-IWjC0Ui5.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=k("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=k("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=k("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=k("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=k("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),q=({children:o,variant:l="ghost",size:p="md",className:a,...d})=>{const h={ghost:"hover:bg-zinc-100 text-zinc-600 dark:hover:bg-zinc-800 dark:text-zinc-400",solid:"bg-zinc-900 text-white hover:bg-black dark:bg-white dark:text-black"},r={sm:"p-2 rounded-full",md:"p-3 rounded-full"};return e.jsx("button",{className:Q("transition-colors inline-flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",h[l],r[p],a),...d,children:o})};q.__docgenInfo={description:"",methods:[],displayName:"IconButton",props:{variant:{required:!1,tsType:{name:"union",raw:"'ghost' | 'solid'",elements:[{name:"literal",value:"'ghost'"},{name:"literal",value:"'solid'"}]},description:"",defaultValue:{value:"'ghost'",computed:!1}},size:{required:!1,tsType:{name:"union",raw:"'sm' | 'md'",elements:[{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"}]},description:"",defaultValue:{value:"'md'",computed:!1}}}};const M=({label:o,id:l,className:p,children:a,...d})=>e.jsxs("div",{className:"space-y-2 relative",children:[o&&e.jsx("label",{htmlFor:l,className:"block text-[10px] font-black text-zinc-400 uppercase tracking-widest",children:o}),e.jsx("select",{id:l,className:Q("w-full px-5 py-4 bg-zinc-100 dark:bg-zinc-900 border-none rounded-2xl focus:ring-0 focus:bg-zinc-200 dark:focus:bg-zinc-800 text-zinc-900 dark:text-white font-bold appearance-none cursor-pointer transition-all",p),...d,children:a}),e.jsx("span",{className:"pointer-events-none absolute right-4 top-[50%] -translate-y-1/2 text-zinc-400",children:"▾"})]});M.__docgenInfo={description:"",methods:[],displayName:"Select",props:{label:{required:!1,tsType:{name:"string"},description:""}}};const U=({isOpen:o,onClose:l,onSave:p,editData:a,initialDay:d,onDelete:h})=>{const{t:r,country:H,config:Z,getCategoryLabel:F}=le(),[x,g]=n.useState(""),[_,N]=n.useState(""),[w,u]=n.useState("1"),[f,L]=n.useState(c.MONTHLY),[I,b]=n.useState(T.OTHER),[Y,y]=n.useState(void 0),[R,m]=n.useState(void 0),[E,v]=n.useState("#64748b"),[z,B]=n.useState(""),[ee,j]=n.useState(!0);n.useEffect(()=>{o&&(a?(g(a.name),N(a.price.toString()),u(a.day.toString()),L(a.recurrence||c.MONTHLY),b(a.category),y(a.logo),m(a.domain),v(a.color),j(!1)):(te(),d&&u(d.toString())))},[o,a,d]);const te=()=>{g(""),N(""),u(new Date().getDate().toString()),L(c.MONTHLY),b(T.OTHER),y(void 0),m(void 0),v("#64748b"),B(""),j(!0)},re=t=>{g(t.name),t.defaultPrice&&N(t.defaultPrice.toString()),b(t.category),v(t.color),y(t.logo),m(t.domain),j(!1)},ae=t=>{const i=t.target.value;g(i);const s=pe(i);s?(y(s.logo),v(s.color),b(s.category),m(s.domain)):(y(void 0),m(void 0),i.includes(".")&&!i.includes(" ")&&m(i),E==="#64748b"&&v("#64748b"))},se=t=>{if(L(t),t===c.WEEKLY){const i=new Date().getDay();u(i.toString())}else u(new Date().getDate().toString())},ne=t=>{t.preventDefault(),!(!x||!_||!w)&&(p({name:x,price:parseFloat(_.replace(",",".")),day:parseInt(w),recurrence:f,category:I,color:E,logo:Y,domain:R}),l())},oe=t=>{t.preventDefault(),t.stopPropagation(),a&&h&&h(a.id)},ie=n.useMemo(()=>{const t=ue(H,z);return me(t)},[z,H]);return e.jsx(he,{isOpen:o,onClose:l,maxWidth:"lg",children:e.jsxs(V.div,{initial:{opacity:0,scale:.98,y:12},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.98,y:12},className:"bg-white dark:bg-zinc-950 rounded-[40px] w-full shadow-2xl overflow-hidden flex flex-col max-h-[85vh] border border-zinc-200 dark:border-zinc-800",children:[e.jsxs("div",{className:"p-6 pb-2 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-extrabold text-zinc-900 dark:text-white tracking-tight",children:r(a?"form.edit_title":"form.add_title")}),e.jsx(q,{"aria-label":"Fermer",onClick:l,className:"bg-zinc-100 dark:bg-zinc-800",children:e.jsx(be,{size:20})})]}),e.jsx("div",{className:"overflow-y-auto px-6 pb-6 scroll-smooth custom-scrollbar relative",children:ee&&!a?e.jsxs("div",{className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",placeholder:`${r("form.search_placeholder")}...`,className:"w-full pl-12 pr-4 py-4 bg-zinc-100 dark:bg-zinc-900 border-none rounded-2xl focus:ring-0 focus:bg-zinc-200 dark:focus:bg-zinc-800 text-zinc-900 dark:text-white placeholder-zinc-400 font-semibold transition-all",value:z,onChange:t=>B(t.target.value),autoFocus:!0}),e.jsx(A,{className:"absolute left-4 top-4 text-zinc-400",size:20})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(O,{type:"button",variant:"secondary",fullWidth:!0,onClick:()=>{g(z),j(!1)},className:"border-dashed",children:[e.jsx("span",{children:r("form.not_in_list")}),e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400",children:r("form.create_manual")})]}),Object.entries(ie).map(([t,i])=>i.length===0?null:e.jsxs("div",{children:[e.jsx("h3",{className:"sticky top-0 bg-white dark:bg-zinc-950 py-2 mb-3 text-[10px] font-black text-zinc-400 uppercase tracking-widest z-30",children:F(t)}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:i.map((s,ce)=>e.jsxs(V.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:ce*.02},onClick:()=>re(s),className:"flex flex-col items-center p-3 rounded-2xl bg-zinc-50 dark:bg-zinc-900 hover:bg-white dark:hover:bg-black border border-transparent hover:border-zinc-200 dark:hover:border-zinc-800 hover:shadow-lg hover:shadow-zinc-200/50 dark:hover:shadow-none transition-all group text-center h-32 justify-center",children:[e.jsx("div",{className:"w-12 h-12 mb-3 rounded-xl overflow-hidden bg-white shadow-sm p-2 group-hover:scale-110 transition-transform",children:e.jsx(W,{name:s.name,logo:s.logo,domain:s.domain,color:s.color,className:"w-full h-full object-contain"})}),e.jsx("span",{className:"text-xs font-bold text-zinc-700 dark:text-zinc-300 line-clamp-1 w-full",children:s.name}),s.defaultPrice&&e.jsxs("span",{className:"text-[10px] text-zinc-400 font-bold mt-1",children:[s.defaultPrice,Z.currency]})]},s.id))})]},t))]})]}):e.jsxs("form",{onSubmit:ne,className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-zinc-50 dark:bg-zinc-900 rounded-3xl",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white shadow-sm p-3 flex-shrink-0",children:e.jsx(W,{name:x,logo:Y,domain:R,color:E,className:"w-full h-full object-contain"})}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("h3",{className:"font-extrabold text-xl text-zinc-900 dark:text-white truncate",children:x||"Nouveau service"}),!a&&e.jsxs(O,{type:"button",variant:"ghost",size:"sm",className:"px-0 text-indigo-600 dark:text-indigo-400 hover:text-indigo-700",onClick:()=>j(!0),children:[e.jsx(A,{size:12}),r("form.change_service")]})]})]}),e.jsx(P,{id:"subscription-name",label:r("form.name_label"),value:x,onChange:ae,required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(M,{id:"subscription-recurrence",label:r("form.recurrence_label"),value:f,onChange:t=>se(t.target.value),children:[e.jsx("option",{value:c.MONTHLY,children:r("rec.monthly")}),e.jsx("option",{value:c.WEEKLY,children:r("rec.weekly")})]}),e.jsx(P,{id:"subscription-price",label:r("form.price_label"),type:"number",step:"0.01",required:!0,placeholder:"0.00",value:_,onChange:t=>N(t.target.value)})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:f===c.MONTHLY?"subscription-day":"subscription-weekday",className:"block text-[10px] font-black text-zinc-400 uppercase tracking-widest mb-2",children:f===c.MONTHLY?r("form.day_label"):r("form.weekday_label")}),f===c.MONTHLY?e.jsxs("div",{className:"relative",children:[e.jsx(P,{id:"subscription-day",type:"number",min:"1",max:"31",required:!0,value:w,onChange:t=>u(t.target.value),className:"pr-10"}),e.jsx(xe,{className:"absolute right-5 top-1/2 -translate-y-1/2 text-zinc-400 pointer-events-none",size:18})]}):e.jsxs(M,{id:"subscription-weekday",value:w,onChange:t=>u(t.target.value),children:[e.jsx("option",{value:"1",children:r("day.1")}),e.jsx("option",{value:"2",children:r("day.2")}),e.jsx("option",{value:"3",children:r("day.3")}),e.jsx("option",{value:"4",children:r("day.4")}),e.jsx("option",{value:"5",children:r("day.5")}),e.jsx("option",{value:"6",children:r("day.6")}),e.jsx("option",{value:"0",children:r("day.0")})]})]})}),e.jsx(M,{id:"subscription-category",label:r("form.category_label"),value:I,onChange:t=>b(t.target.value),children:Object.values(T).map(t=>e.jsx("option",{value:t,children:F(t)},t))}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[a&&h&&e.jsx(q,{type:"button","aria-label":r("modal.confirm"),onClick:oe,className:"bg-red-50 hover:bg-red-100 text-red-600 dark:bg-red-900/20 dark:hover:bg-red-900/30 dark:text-red-400 rounded-2xl",children:e.jsx(fe,{size:24})}),e.jsxs(O,{type:"submit",className:"flex-1 text-lg gap-2",children:[e.jsx(ge,{size:20,strokeWidth:3}),r(a?"form.save":"form.add")]})]})]})})]})})};U.__docgenInfo={description:"",methods:[],displayName:"SubscriptionForm",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSave:{required:!0,tsType:{name:"signature",type:"function",raw:"(sub: Omit<Subscription, 'id'>) => void",signature:{arguments:[{type:{name:"Omit",elements:[{name:"Subscription"},{name:"literal",value:"'id'"}],raw:"Omit<Subscription, 'id'>"},name:"sub"}],return:{name:"void"}}},description:""},editData:{required:!1,tsType:{name:"union",raw:"Subscription | null",elements:[{name:"Subscription"},{name:"null"}]},description:""},initialDay:{required:!1,tsType:{name:"number"},description:""},onDelete:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""}}};const ye={id:"1",name:"Netflix",price:15,day:10,recurrence:c.MONTHLY,category:T.ENTERTAINMENT,color:"#E50914"},Le={title:"Métiers/SubscriptionForm",component:U,decorators:[o=>e.jsx(de,{children:e.jsx(o,{})})],args:{isOpen:!0,onClose:()=>{},onSave:()=>{},editData:ye,onDelete:()=>{}}},S={},C={args:{editData:void 0,initialDay:5}};var K,X,D;S.parameters={...S.parameters,docs:{...(K=S.parameters)==null?void 0:K.docs,source:{originalSource:"{}",...(D=(X=S.parameters)==null?void 0:X.docs)==null?void 0:D.source}}};var $,G,J;C.parameters={...C.parameters,docs:{...($=C.parameters)==null?void 0:$.docs,source:{originalSource:`{
  args: {
    editData: undefined,
    initialDay: 5
  }
}`,...(J=(G=C.parameters)==null?void 0:G.docs)==null?void 0:J.source}}};const Ee=["EditMode","CreateMode"];export{C as CreateMode,S as EditMode,Ee as __namedExportsOrder,Le as default};
